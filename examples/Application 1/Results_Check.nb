(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32597,        810]
NotebookOptionsPosition[     31192,        758]
NotebookOutlinePosition[     31532,        773]
CellTagsIndexPosition[     31489,        770]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "QSWalk`"}]}], "Input",
 CellChangeTimes->{{3.779363241166305*^9, 3.779363253925026*^9}, 
   3.779363302689283*^9, {3.779366731569379*^9, 3.779366734081011*^9}, {
   3.779366982288025*^9, 3.779366984104795*^9}}],

Cell[BoxData["\<\"/home/edric/Documents/Masters/FreeQSW/examples/Application \
1\"\>"], "Output",
 CellChangeTimes->{
  3.779366984640424*^9, 3.7793670240718603`*^9, 3.7793672819787493`*^9, 
   3.779367374879903*^9, 3.779367489873877*^9, 3.779367642677449*^9, {
   3.779367680166131*^9, 3.779367689610367*^9}, 3.779367816023184*^9, 
   3.779368153462357*^9, {3.779368241707295*^9, 3.779368267805724*^9}, 
   3.779368309326717*^9, {3.7793690972720737`*^9, 3.7793691139484653`*^9}, 
   3.7793694643105297`*^9, 3.779369520674263*^9, 3.779369702913126*^9, 
   3.779370174040604*^9, 3.7793702755495234`*^9, 3.779370308455772*^9, {
   3.779370381592696*^9, 3.7793703988824997`*^9}, {3.779370585974235*^9, 
   3.779370616471506*^9}, {3.779370659829076*^9, 3.779370676416222*^9}, {
   3.779370775335051*^9, 3.7793708033367863`*^9}, 3.779370836530509*^9, 
   3.7793709288729277`*^9, 3.7793710256719646`*^9, 3.779372321622328*^9, {
   3.7793725038494596`*^9, 3.779372526927112*^9}, 3.779372566989242*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"QuantumStochasticWalk2", "[", 
    RowBox[{
    "H_", ",", " ", "LkList_", ",", "LkList2_", ",", " ", "omega_", ",", 
     "nh_", ",", " ", "rho0_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "H", "]"}]}], ",", " ", "id", ",", " ", 
       "LdagL", ",", " ", "masterL"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"id", " ", "=", " ", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"n", ",", " ", "SparseArray"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"vectorized", " ", "master", " ", "equation", " ", "matrix"}], 
       " ", "*)"}], "\n", "\t", 
      RowBox[{"masterL", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "-", "omega"}], ")"}]}], " ", "I", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"id", ",", " ", "H"}], "]"}], " ", "-", " ", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "H", "]"}], ",", "id"}], "]"}]}], 
          ")"}]}], " ", "+", "\n", "\t\t", 
        RowBox[{"omega", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", "L", "]"}], ",", " ", "L"}], "]"}], 
            " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"KroneckerProduct", "[", 
                RowBox[{"id", ",", " ", 
                 RowBox[{
                  RowBox[{"ConjugateTranspose", "[", "L", "]"}], ".", "L"}]}],
                 "]"}], " ", "+", " ", "\n", "\t\t\t", 
               RowBox[{"KroneckerProduct", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "L", "]"}], ".", 
                  RowBox[{"Conjugate", "[", "L", "]"}]}], ",", " ", "id"}], 
                "]"}]}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"L", ",", " ", "LkList"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"nh", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", "L", "]"}], ",", " ", "L"}], "]"}], 
            " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"KroneckerProduct", "[", 
                RowBox[{"id", ",", " ", 
                 RowBox[{
                  RowBox[{"ConjugateTranspose", "[", "L", "]"}], ".", "L"}]}],
                 "]"}], " ", "+", " ", "\n", "\t\t\t", 
               RowBox[{"KroneckerProduct", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "L", "]"}], ".", 
                  RowBox[{"Conjugate", "[", "L", "]"}]}], ",", " ", "id"}], 
                "]"}]}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"L", ",", " ", "LkList2"}], "}"}]}], "]"}]}]}]}], ";", 
      "\n", "\t", 
      RowBox[{"(*", " ", "solution", " ", "*)"}], "\n", "\t", 
      RowBox[{"Matricize", " ", "@", " ", 
       RowBox[{"MatrixExp", "[", 
        RowBox[{
         RowBox[{"masterL", " ", "t"}], ",", " ", 
         RowBox[{"Vectorize", "[", "rho0", "]"}]}], "]"}]}]}]}], "\n", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"operator", "[", 
    RowBox[{
    "H_", ",", " ", "LkList_", ",", "LkList2_", ",", " ", "omega_", ",", 
     "nh_", ",", " ", "rho0_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "H", "]"}]}], ",", " ", "id", ",", " ", 
       "LdagL", ",", " ", "masterL"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"id", " ", "=", " ", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"n", ",", " ", "SparseArray"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"vectorized", " ", "master", " ", "equation", " ", "matrix"}], 
       " ", "*)"}], "\n", "\t", 
      RowBox[{"masterL", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "-", "omega"}], ")"}]}], " ", "I", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{"id", ",", " ", "H"}], "]"}], " ", "-", " ", 
           RowBox[{"KroneckerProduct", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "H", "]"}], ",", "id"}], "]"}]}], 
          ")"}]}], " ", "+", "\n", "\t\t", 
        RowBox[{"omega", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", "L", "]"}], ",", " ", "L"}], "]"}], 
            " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"KroneckerProduct", "[", 
                RowBox[{"id", ",", " ", 
                 RowBox[{
                  RowBox[{"ConjugateTranspose", "[", "L", "]"}], ".", "L"}]}],
                 "]"}], " ", "+", " ", "\n", "\t\t\t", 
               RowBox[{"KroneckerProduct", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "L", "]"}], ".", 
                  RowBox[{"Conjugate", "[", "L", "]"}]}], ",", " ", "id"}], 
                "]"}]}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"L", ",", " ", "LkList"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"nh", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", "L", "]"}], ",", " ", "L"}], "]"}], 
            " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"KroneckerProduct", "[", 
                RowBox[{"id", ",", " ", 
                 RowBox[{
                  RowBox[{"ConjugateTranspose", "[", "L", "]"}], ".", "L"}]}],
                 "]"}], " ", "+", " ", "\n", "\t\t\t", 
               RowBox[{"KroneckerProduct", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "L", "]"}], ".", 
                  RowBox[{"Conjugate", "[", "L", "]"}]}], ",", " ", "id"}], 
                "]"}]}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"L", ",", " ", "LkList2"}], "}"}]}], "]"}]}]}]}]}]}], 
    "\n", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7793670819849653`*^9, 3.7793672321374073`*^9}, {
  3.7793679802745934`*^9, 3.7793679978578377`*^9}, {3.779368061625722*^9, 
  3.77936808108204*^9}, {3.779370264806448*^9, 3.779370303402763*^9}, {
  3.779370376443603*^9, 3.779370394162284*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{"0", ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "8"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7793725040501966`*^9, 3.779372527073203*^9}, 
   3.779372567222492*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "1", "0"},
     {"1", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "1", "0"},
     {"0", "0", "0", "0", "1", "1", "0", "0"},
     {"0", "0", "1", "1", "0", "0", "0", "0"},
     {"0", "1", "0", "1", "0", "0", "0", "0"},
     {"1", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{{3.7793724894789953`*^9, 3.7793724894853*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.779372504210829*^9, 3.7793725271882677`*^9}, 
   3.779372567241949*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"1", "0", "1", "0", "0", "0", "1", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "1", "0"},
     {"0", "0", "0", "1", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "1", "0"},
     {"0", "1", "0", "1", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{{3.779366554039497*^9, 3.779366554045773*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.779366963700931*^9, 3.779367024824888*^9, 3.7793673757654877`*^9, 
   3.779367817132763*^9, 3.779368153565048*^9, {3.779368242074236*^9, 
   3.779368267899084*^9}, 3.77936830941818*^9, {3.779369097739386*^9, 
   3.779369114108313*^9}, 3.7793694647573957`*^9, 3.77936952226796*^9, 
   3.779369704394548*^9, 3.779370174499003*^9, 3.779370276092731*^9, 
   3.779370309017174*^9, {3.7793703822707777`*^9, 3.7793703993084183`*^9}, {
   3.779370586350423*^9, 3.7793706167783012`*^9}, {3.7793706601309147`*^9, 
   3.779370676718289*^9}, {3.7793707755781937`*^9, 3.779370803518664*^9}, 
   3.779370836823947*^9, 3.779370929115419*^9, 3.779371025934147*^9, 
   3.779372321737376*^9, {3.7793725043597383`*^9, 3.7793725271945953`*^9}, 
   3.779372567385147*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{"Import", "[", "\"\<isomorphic_graphs/32.mtx\>\"", "]"}], "//", 
   "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.779363494004727*^9, 3.779363542886758*^9}, 
   3.779363708620038*^9, {3.779364266162715*^9, 3.7793642664022007`*^9}, {
   3.779372470149502*^9, 3.779372470625476*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "1"},
     {"1", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1", "0", "1"},
     {"0", "0", "0", "0", "1", "1", "0"},
     {"0", "0", "1", "1", "0", "0", "0"},
     {"0", "1", "0", "1", "0", "0", "0"},
     {"1", "0", "1", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.779363516875856*^9, 3.7793635433559923`*^9}, 
   3.779363709263756*^9, 3.779363761643903*^9, 3.7793642684122562`*^9, 
   3.779365654005784*^9, 3.7793656896162367`*^9, 3.779365943612756*^9, 
   3.779366081506794*^9, 3.779366241631886*^9, 3.7793662890474367`*^9, 
   3.779366963906728*^9, 3.779367025168392*^9, 3.779367376055986*^9, 
   3.779367622328968*^9, 3.77936769884641*^9, 3.779367817513632*^9, 
   3.779368153588853*^9, {3.779368242412589*^9, 3.7793682679473553`*^9}, 
   3.7793683094442673`*^9, {3.779369097946499*^9, 3.779369114243103*^9}, 
   3.7793694649622393`*^9, 3.7793695227214127`*^9, 3.7793697050264807`*^9, 
   3.779370174754401*^9, 3.779370276267318*^9, 3.779370309183012*^9, {
   3.779370382472159*^9, 3.7793703994759083`*^9}, {3.779370586480673*^9, 
   3.779370617036948*^9}, {3.779370660401732*^9, 3.779370676986678*^9}, {
   3.7793707756834507`*^9, 3.779370803624791*^9}, 3.779370837082082*^9, 
   3.779370929226287*^9, 3.77937102616321*^9, 3.7793723218037148`*^9, 
   3.779372471417737*^9, {3.779372504468645*^9, 3.7793725273118277`*^9}, 
   3.779372567498247*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Gcoh", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0", "0", "0", "1", "0"},
       {"1", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "1", "0"},
       {"0", "0", "0", "0", "1", "1", "0", "0"},
       {"0", "0", "1", "1", "0", "0", "0", "0"},
       {"0", "1", "0", "1", "0", "0", "0", "0"},
       {"1", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Glind", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0", "0", "0", "1", "0"},
       {"1", "0", "0", "0", "0", "1", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "1", "0"},
       {"0", "0", "0", "0", "1", "1", "0", "0"},
       {"0", "0", "1", "1", "0", "0", "0", "0"},
       {"0", "1", "0", "1", "0", "0", "0", "0"},
       {"1", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trap", " ", "=", " ", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "3", "0", "0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.779363547501667*^9, 3.779363636679997*^9}, {
  3.779363810937189*^9, 3.77936381769571*^9}, {3.779364306967373*^9, 
  3.77936431575963*^9}, {3.7793663194085827`*^9, 3.779366326983231*^9}, {
  3.779366450758843*^9, 3.7793664530466146`*^9}, {3.779366562696602*^9, 
  3.779366597543602*^9}, {3.7793679273150387`*^9, 3.7793679377052526`*^9}, {
  3.779368233178686*^9, 3.7793682647142973`*^9}, {3.7793694532243853`*^9, 
  3.7793694556050577`*^9}, {3.779369508049996*^9, 3.7793695123734922`*^9}, {
  3.779370051867305*^9, 3.779370052960848*^9}, {3.779370198094048*^9, 
  3.779370198568461*^9}, {3.779370577969283*^9, 3.779370625421296*^9}, {
  3.779370672329135*^9, 3.7793706737188473`*^9}, {3.779370827814432*^9, 
  3.7793708330628843`*^9}, {3.779371464038361*^9, 3.779371495355813*^9}, {
  3.779372495035372*^9, 3.77937252355064*^9}, {3.779372562146409*^9, 
  3.7793725626243057`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gamma", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"GeneratorMatrix", "[", 
    RowBox[{
     RowBox[{"AdjacencyGraph", "[", "Gcoh", "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LkSet", "=", 
   RowBox[{"LindbladSet", "[", 
    RowBox[{"GeneratorMatrix", "[", 
     RowBox[{
      RowBox[{"AdjacencyGraph", "[", "Glind", "]"}], ",", "1"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LkSet2", "=", 
   RowBox[{"LindbladSet", "[", "trap", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", 
    RowBox[{"[", 
     RowBox[{"6", ",", "6"}], "]"}], "]"}], "=", "1.0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"rhot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"QuantumStochasticWalk2", "[", 
     RowBox[{
     "H", ",", "LkSet", ",", "LkSet2", ",", "0.0", ",", "1", ",", "rho", ",", 
      "400"}], "]"}], "//", "Chop"}], "//", "Diagonal"}]}]}], "Input",
 CellChangeTimes->{{3.779363435725234*^9, 3.7793634420049458`*^9}, {
   3.779363643767661*^9, 3.779363683821847*^9}, {3.779364338938323*^9, 
   3.779364347466506*^9}, {3.779364402015139*^9, 3.779364412663537*^9}, {
   3.779365916490964*^9, 3.779365917156673*^9}, {3.779365998762073*^9, 
   3.779365999329805*^9}, {3.779366616776622*^9, 3.779366626866164*^9}, {
   3.779366742841902*^9, 3.779366774687126*^9}, {3.779366887995832*^9, 
   3.779366888592918*^9}, {3.7793669708652983`*^9, 3.779366971200987*^9}, 
   3.779367246777286*^9, {3.7793672991297913`*^9, 3.779367323403532*^9}, {
   3.7793679088254147`*^9, 3.779367914697363*^9}, {3.779367946889224*^9, 
   3.779367964449189*^9}, {3.779368177842181*^9, 3.779368178289706*^9}, {
   3.779369046224518*^9, 3.779369054149962*^9}, {3.779369092415625*^9, 
   3.7793690926146507`*^9}, {3.779369162727618*^9, 3.779369173317727*^9}, {
   3.779369638522573*^9, 3.779369639624158*^9}, {3.7793697457782183`*^9, 
   3.779369747248481*^9}, {3.779370078222414*^9, 3.779370079592637*^9}, {
   3.779370202498314*^9, 3.779370204584629*^9}, {3.779370754792255*^9, 
   3.779370761106761*^9}, {3.7793709064246197`*^9, 3.7793709253060226`*^9}, {
   3.779371021029414*^9, 3.779371021379078*^9}, {3.779371454429719*^9, 
   3.7793714547067747`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.05535559551276675`", ",", "0.056719848362835966`", ",", "0", ",", 
   "0.05535559551276681`", ",", "0.13792455612442045`", ",", 
   "0.056719848362835924`", ",", "0.13792455612442042`", ",", 
   "0.49999999999994266`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.779369179269075*^9, {3.779369457857329*^9, 3.779369465206626*^9}, {
   3.779369515809219*^9, 3.779369523438223*^9}, 3.779369640571589*^9, 
   3.779369707856659*^9, 3.779369750423195*^9, {3.779370056898861*^9, 
   3.779370080734406*^9}, 3.779370175038822*^9, 3.77937021649319*^9, 
   3.779370276509514*^9, 3.7793703093606787`*^9, {3.7793703828255243`*^9, 
   3.779370399643969*^9}, {3.77937058268862*^9, 3.7793706173111677`*^9}, {
   3.7793706606346827`*^9, 3.7793706772698793`*^9}, {3.77937077584824*^9, 
   3.779370803723164*^9}, 3.779370837303288*^9, 3.779370929402158*^9, 
   3.779371026386189*^9, {3.779371455594479*^9, 3.779371497857226*^9}, 
   3.77937232189568*^9, {3.779372504617715*^9, 3.779372527548457*^9}, 
   3.779372567729941*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"M1", " ", "=", 
   RowBox[{"operator", "[", 
    RowBox[{
    "H", ",", "LkSet", ",", "LkSet2", ",", "0.0", ",", "1", ",", "rho", ",", 
     "300"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.779364755777151*^9, 3.7793647595257587`*^9}, {
  3.7793648208969107`*^9, 3.7793648764223213`*^9}, {3.7793655466572247`*^9, 
  3.779365555661422*^9}, {3.7793660261455927`*^9, 3.779366028977371*^9}, {
  3.7793681126436577`*^9, 3.7793681149296703`*^9}, {3.779368172522018*^9, 
  3.779368173761649*^9}, {3.779369110199169*^9, 3.779369110395846*^9}, {
  3.779369177157716*^9, 3.779369177662627*^9}, {3.7793696600420303`*^9, 
  3.779369661125839*^9}, {3.7793697680772448`*^9, 3.779369769104315*^9}, {
  3.779370084999958*^9, 3.779370085616539*^9}, {3.77937020906074*^9, 
  3.779370215272091*^9}, {3.779370771026284*^9, 3.7793707725443363`*^9}, {
  3.779370900493176*^9, 3.779370902949441*^9}, {3.77937099752731*^9, 
  3.779370997951297*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Import", "[", "\"\<32.mtx\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.779365397442827*^9, 3.7793654139156723`*^9}, {
  3.779366203464818*^9, 3.7793662092081223`*^9}, {3.7793688320246687`*^9, 
  3.779368834849558*^9}, {3.7793724640993423`*^9, 3.779372464513731*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.779368658623294*^9, 3.7793686787416487`*^9}, 
   3.7793688455508966`*^9, {3.779368958431157*^9, 3.7793689617772512`*^9}}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"1.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.779368680983858*^9, 3.7793688483955317`*^9, 3.779368924264187*^9, 
   3.779368962598937*^9, {3.77936909880686*^9, 3.77936911437352*^9}, 
   3.7793692196719503`*^9, 3.779369465476478*^9, 3.779369524069872*^9, 
   3.77936966436731*^9, 3.7793697085080233`*^9, {3.779369758469988*^9, 
   3.779369773252561*^9}, 3.779370090400323*^9, 3.779370175320451*^9, 
   3.779370276824929*^9, 3.779370309576509*^9, {3.77937038306698*^9, 
   3.779370399877336*^9}, {3.7793705868676147`*^9, 3.779370617490705*^9}, {
   3.7793706608322477`*^9, 3.779370677521904*^9}, {3.7793707759975557`*^9, 
   3.779370803798101*^9}, 3.779370837475471*^9, 3.7793709295630913`*^9, 
   3.779371026548913*^9, 3.779372321988226*^9, {3.779372504794116*^9, 
   3.7793725277112217`*^9}, 3.7793725679087543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M1", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.779368965558385*^9, 3.779368969746192*^9}}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"1.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.779368970317279*^9, {3.7793690991451073`*^9, 3.77936911445509*^9}, 
   3.7793692163862867`*^9, 3.779369465688219*^9, 3.7793695246368647`*^9, 
   3.779369665470677*^9, 3.779369709103917*^9, {3.779369759390675*^9, 
   3.779369774341793*^9}, 3.779370091724332*^9, 3.779370175330208*^9, 
   3.779370309581451*^9, {3.7793703832749033`*^9, 3.779370399994143*^9}, {
   3.7793705870085077`*^9, 3.779370617651408*^9}, {3.779370661011633*^9, 
   3.779370677531554*^9}, {3.779370776111911*^9, 3.779370803854949*^9}, 
   3.7793708376147957`*^9, 3.7793709297008038`*^9, 3.7793710266685534`*^9, 
   3.77937232205217*^9, {3.779372504945719*^9, 3.7793725278399057`*^9}, 
   3.77937256803893*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"M", "-", "M1"}], "]"}], "//", "Diagonal"}], "//", "Chop"}], "//",
   "Normal"}]], "Input",
 CellChangeTimes->{{3.779368982073503*^9, 3.779369001377582*^9}, {
  3.779369328382121*^9, 3.779369335588784*^9}, {3.779369796046536*^9, 
  3.779369832896242*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.779368983814782*^9, 3.779369001863578*^9}, {
   3.779369099820725*^9, 3.779369114922226*^9}, 3.779369193676724*^9, {
   3.779369330782275*^9, 3.779369336033588*^9}, 3.779369466016244*^9, 
   3.77936952576075*^9, 3.77936966771984*^9, 3.7793697103437967`*^9, {
   3.7793697606847258`*^9, 3.7793698333047028`*^9}, {3.7793700659040003`*^9, 
   3.7793700934787807`*^9}, 3.7793701754768343`*^9, 3.7793702228069687`*^9, 
   3.779370309743775*^9, {3.779370383483808*^9, 3.779370400134881*^9}, {
   3.779370587189764*^9, 3.7793706176568813`*^9}, {3.77937066118711*^9, 
   3.779370677669324*^9}, {3.7793707761166697`*^9, 3.7793708039120417`*^9}, 
   3.779370837735504*^9, 3.779370929812607*^9, 3.779371026673531*^9, 
   3.77937232213198*^9, {3.779372505102614*^9, 3.779372527849666*^9}, 
   3.779372568196384*^9}]
}, Open  ]]
},
WindowSize->{1279, 1413},
WindowMargins->{{Automatic, -269}, {-945, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 346, 6, 51, "Input"],
Cell[929, 30, 994, 14, 32, "Output"]
}, Open  ]],
Cell[1938, 47, 7423, 185, 417, "Input"],
Cell[CellGroupData[{
Cell[9386, 236, 227, 7, 32, "Input"],
Cell[9616, 245, 1021, 25, 178, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10674, 275, 992, 24, 164, InheritFromParent],
Cell[11669, 301, 1187, 36, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12893, 342, 992, 24, 164, InheritFromParent],
Cell[13888, 368, 1868, 46, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15793, 419, 341, 7, 33, "Input"],
Cell[16137, 428, 1955, 38, 159, "Output"]
}, Open  ]],
Cell[18107, 469, 3963, 88, 518, "Input"],
Cell[CellGroupData[{
Cell[22095, 561, 2576, 58, 152, "Input"],
Cell[24674, 621, 1052, 18, 32, "Output"]
}, Open  ]],
Cell[25741, 642, 968, 17, 32, "Input"],
Cell[26712, 661, 332, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[27069, 671, 245, 5, 32, "Input"],
Cell[27317, 678, 904, 14, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28258, 697, 168, 4, 32, "Input"],
Cell[28429, 703, 813, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29279, 721, 340, 9, 32, "Input"],
Cell[29622, 732, 1554, 23, 85, "Output"]
}, Open  ]]
}
]
*)

